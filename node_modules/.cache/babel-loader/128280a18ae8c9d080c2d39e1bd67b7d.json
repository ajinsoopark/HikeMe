{"ast":null,"code":"import _regeneratorRuntime from \"/Users/alexpark/pursuit/hackathon/HikeMe/frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/alexpark/pursuit/hackathon/HikeMe/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/alexpark/pursuit/hackathon/HikeMe/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/alexpark/pursuit/hackathon/HikeMe/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/alexpark/pursuit/hackathon/HikeMe/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/alexpark/pursuit/hackathon/HikeMe/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/alexpark/pursuit/hackathon/HikeMe/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/alexpark/pursuit/hackathon/HikeMe/frontend/src/components/Home/home.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport Map from \"./map.js\";\nimport SideBar from \"./sidebar.js\";\nimport DistanceMenu from \"./distanceMenu.js\";\nimport SearchBox from \"./searchbox.js\";\nimport SortMenu from \"./sortMenu.js\";\nimport \"../../css/Home.css\";\n\nvar Home =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Home, _Component);\n\n  function Home() {\n    var _this;\n\n    _classCallCheck(this, Home);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Home).call(this));\n\n    _this.getDistanceData = function (string) {\n      var _this$state = _this.state,\n          longitude = _this$state.longitude,\n          latitude = _this$state.latitude,\n          markers = _this$state.markers;\n      axios.get(\"https://cors-anywhere.herokuapp.com/https://maps.googleapis.com/maps/api/distancematrix/json?units=imperial&origins=\".concat(latitude, \",\").concat(longitude, \"&destinations=\").concat(string, \"&key=AIzaSyAm8VcTZZ0P2oJCVLZ4ZDy5RK2UYxMxDlc\")).then(function (res) {\n        var normalizeDistance = res.data.rows[0].elements.map(function (el) {\n          return el = el.distance.text;\n        });\n        var addedDistance = markers.slice();\n        addedDistance.forEach(function (trail, i) {\n          trail.distance = normalizeDistance[i];\n        });\n\n        _this.setState({\n          markers: addedDistance\n        });\n      });\n    };\n\n    _this.fetchLocation = function () {\n      // console.log(\"fetchLocation!!!\");\n      return axios.get(\"https://www.hikingproject.com/data/get-trails?lat=\".concat(_this.state.latitude, \"&lon=\").concat(_this.state.longitude, \"&maxDistance=\").concat(_this.state.distanceChoice, \"&key=200430061-384fefbb8ceed621af7cea7e5ab597b2\")).then(function (res) {\n        _this.setState({\n          markers: res.data.trails\n        });\n      }).catch(function (err) {\n        console.log(err);\n      });\n    };\n\n    _this.coordinateString = function () {\n      return _this.state.markers.map(function (el) {\n        return el.latitude + \"%2C\" + el.longitude + \"%7C\";\n      }).join(\"\").slice(0, -3); // console.log(\"coorStr=>\",output,this.state.markers);\n    };\n\n    _this.handleSort = function (e) {\n      var markers = _this.state.markers;\n      var newMarkers = markers.slice(0);\n\n      switch (e.target.value) {\n        case \"len\":\n          newMarkers.sort(_this.lengthComparator);\n          break;\n\n        case \"dis\":\n          newMarkers.sort(_this.distanceComparator);\n          break;\n\n        case \"dif\":\n          newMarkers.sort(_this.difficultyComparator);\n          break;\n\n        default:\n          return null;\n      }\n\n      _this.setState({\n        markers: newMarkers\n      });\n    };\n\n    _this.lengthComparator = function (a, b) {\n      return a.length - b.length;\n    };\n\n    _this.distanceComparator = function (a, b) {\n      return parseFloat(a.distance) - parseFloat(b.distance);\n    };\n\n    _this.difficultyComparator = function (a, b) {\n      return _this.levelToNum(a.difficulty) - _this.levelToNum(b.difficulty);\n    };\n\n    _this.levelToNum = function (level) {\n      switch (level) {\n        case \"green\":\n          return 1;\n\n        case \"greenBlue\":\n          return 2;\n\n        case \"blue\":\n          return 3;\n\n        case \"blueBlack\":\n          return 4;\n\n        case \"black\":\n          return 5;\n\n        default:\n          return \"\";\n      }\n    };\n\n    _this.selectDistance =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return _this.setState({\n                  distanceChoice: Number(event.target.value)\n                });\n\n              case 2:\n                _context.next = 4;\n                return _this.fetchLocation();\n\n              case 4:\n                _context.next = 6;\n                return _this.getDistanceData(_this.coordinateString());\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.searchCoordinates = function (event) {\n      event.preventDefault();\n      axios.get(\"https://maps.googleapis.com/maps/api/geocode/json?address=\".concat(_this.state.searchInput, \"&key=AIzaSyAm8VcTZZ0P2oJCVLZ4ZDy5RK2UYxMxDlc\")).then(function (res) {\n        _this.setState({\n          latitude: res.data.results[0].geometry.location.lat,\n          longitude: res.data.results[0].geometry.location.lng,\n          searchInput: \"\"\n        });\n      }).then(function () {\n        _this.fetchLocation().then(function () {\n          _this.getDistanceData(_this.coordinateString());\n        });\n      });\n    };\n\n    _this.handleSearchInput = function (event) {\n      event.preventDefault();\n\n      _this.setState({\n        searchInput: event.target.value\n      });\n    };\n\n    _this.state = {\n      markers: [],\n      latitude: \"\",\n      longitude: \"\",\n      userIP: \"\",\n      distances: [],\n      distanceChoice: 10,\n      searchInput: \"\"\n    };\n    return _this;\n  }\n\n  _createClass(Home, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      axios.get(\"https://jsonip.com/\").then(function (res) {\n        _this2.setState({\n          userIP: res.data.ip\n        }); // console.log(\"ip: \", res.data.ip);\n\n      }).then(function () {\n        var apikey = \"45c642a38d6e8f01dac07ba1f003505a\";\n        axios.get(\"http://api.ipstack.com/\".concat(_this2.state.userIP, \"?access_key=\").concat(apikey)).then(function (res) {\n          // console.log(\"result long/ lat!!!: \", res)\n          _this2.setState({\n            latitude: res.data.latitude,\n            longitude: res.data.longitude\n          });\n        }).then(function () {\n          _this2.fetchLocation().then(function () {\n            _this2.getDistanceData(_this2.coordinateString());\n          });\n        });\n      }).catch(function (err) {\n        console.log(err);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      // console.log(this.props)\n      var _this$state2 = this.state,\n          markers = _this$state2.markers,\n          latitude = _this$state2.latitude,\n          longitude = _this$state2.longitude,\n          userIP = _this$state2.userIP,\n          distances = _this$state2.distances,\n          distanceChoice = _this$state2.distanceChoice;\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"home-main-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, React.createElement(SideBar, {\n        props: this.props,\n        distances: distances,\n        trails: markers,\n        currentLon: longitude,\n        currentLat: latitude,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }), React.createElement(Map, {\n        markers: markers,\n        latitude: latitude,\n        longitude: longitude,\n        userIP: userIP,\n        distanceChoice: distanceChoice,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"home-menus-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, React.createElement(DistanceMenu, {\n        selectDistance: this.selectDistance,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }), React.createElement(SortMenu, {\n        handleSort: this.handleSort,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }), React.createElement(SearchBox, {\n        handleSearchInput: this.handleSearchInput,\n        searchCoordinates: this.searchCoordinates,\n        searchInput: this.state.searchInput,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return Home;\n}(Component);\n\nexport { Home as default };","map":{"version":3,"sources":["/Users/alexpark/pursuit/hackathon/HikeMe/frontend/src/components/Home/home.js"],"names":["React","Component","axios","Map","SideBar","DistanceMenu","SearchBox","SortMenu","Home","getDistanceData","string","state","longitude","latitude","markers","get","then","res","normalizeDistance","data","rows","elements","map","el","distance","text","addedDistance","slice","forEach","trail","i","setState","fetchLocation","distanceChoice","trails","catch","err","console","log","coordinateString","join","handleSort","e","newMarkers","target","value","sort","lengthComparator","distanceComparator","difficultyComparator","a","b","length","parseFloat","levelToNum","difficulty","level","selectDistance","event","Number","searchCoordinates","preventDefault","searchInput","results","geometry","location","lat","lng","handleSearchInput","userIP","distances","ip","apikey","props"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\n\nimport Map from \"./map.js\";\nimport SideBar from \"./sidebar.js\";\nimport DistanceMenu from \"./distanceMenu.js\";\n\nimport SearchBox from \"./searchbox.js\";\nimport SortMenu from \"./sortMenu.js\";\n\nimport \"../../css/Home.css\";\n\nexport default class Home extends Component {\n  constructor() {\n    super();\n    this.state = {\n      markers: [],\n      latitude: \"\",\n      longitude: \"\",\n      userIP: \"\",\n      distances: [],\n      distanceChoice: 10,\n      searchInput: \"\"\n    };\n  }\n\n  componentDidMount() {\n    axios\n      .get(\"https://jsonip.com/\")\n      .then(res => {\n        this.setState({\n          userIP: res.data.ip\n        });\n        // console.log(\"ip: \", res.data.ip);\n      })\n      .then(() => {\n        let apikey = \"45c642a38d6e8f01dac07ba1f003505a\";\n        axios\n          .get(\n            `http://api.ipstack.com/${this.state.userIP}?access_key=${apikey}`\n          )\n          .then(res => {\n            // console.log(\"result long/ lat!!!: \", res)\n            this.setState({\n              latitude: res.data.latitude,\n              longitude: res.data.longitude\n            });\n          })\n          .then(() => {\n            this.fetchLocation().then(() => {\n              this.getDistanceData(this.coordinateString());\n            });\n          });\n      })\n      .catch(err => {\n        console.log(err);\n      });\n  }\n\n  getDistanceData = string => {\n    let { longitude, latitude, markers } = this.state;\n    axios\n      .get(\n        `https://cors-anywhere.herokuapp.com/https://maps.googleapis.com/maps/api/distancematrix/json?units=imperial&origins=${latitude},${longitude}&destinations=${string}&key=AIzaSyAm8VcTZZ0P2oJCVLZ4ZDy5RK2UYxMxDlc`\n      )\n      .then(res => {\n        let normalizeDistance = res.data.rows[0].elements.map(el => {\n          return (el = el.distance.text);\n        });\n        let addedDistance = markers.slice();\n        addedDistance.forEach((trail, i) => {\n          trail.distance = normalizeDistance[i];\n        });\n        this.setState({\n          markers: addedDistance\n        });\n      });\n  };\n\n  fetchLocation = () => {\n    // console.log(\"fetchLocation!!!\");\n    return axios\n      .get(\n        `https://www.hikingproject.com/data/get-trails?lat=${\n          this.state.latitude\n        }&lon=${this.state.longitude}&maxDistance=${\n          this.state.distanceChoice\n        }&key=200430061-384fefbb8ceed621af7cea7e5ab597b2`\n      )\n      .then(res => {\n        this.setState({\n          markers: res.data.trails\n        });\n      })\n      .catch(err => {\n        console.log(err);\n      });\n  };\n\n  coordinateString = () => {\n    return this.state.markers\n      .map(el => {\n        return el.latitude + \"%2C\" + el.longitude + \"%7C\";\n      })\n      .join(\"\")\n      .slice(0, -3);\n    // console.log(\"coorStr=>\",output,this.state.markers);\n  };\n\n  handleSort = e => {\n    let { markers } = this.state;\n    let newMarkers = markers.slice(0);\n    switch (e.target.value) {\n      case \"len\":\n        newMarkers.sort(this.lengthComparator);\n        break;\n      case \"dis\":\n        newMarkers.sort(this.distanceComparator);\n        break;\n      case \"dif\":\n        newMarkers.sort(this.difficultyComparator);\n        break;\n      default: return null\n    }\n    this.setState({\n      markers: newMarkers\n    });\n  };\n\n  //three helper custom comparators\n  lengthComparator = (a, b) => {\n    return a.length - b.length;\n  };\n\n  distanceComparator = (a, b) => {\n    return parseFloat(a.distance) - parseFloat(b.distance);\n  };\n\n  difficultyComparator = (a, b) => {\n    return this.levelToNum(a.difficulty) - this.levelToNum(b.difficulty);\n  };\n\n  levelToNum = level => {\n    switch (level) {\n      case \"green\":\n        return 1;\n      case \"greenBlue\":\n        return 2;\n      case \"blue\":\n        return 3;\n      case \"blueBlack\":\n        return 4;\n      case \"black\":\n        return 5;\n      default:\n        return \"\";\n    }\n  };\n\n  selectDistance = async event => {\n    await this.setState({\n      distanceChoice: Number(event.target.value)\n    });\n    await this.fetchLocation();\n    await this.getDistanceData(this.coordinateString());\n  };\n\n  searchCoordinates = event => {\n    event.preventDefault();\n    axios\n      .get(\n        `https://maps.googleapis.com/maps/api/geocode/json?address=${\n          this.state.searchInput\n        }&key=AIzaSyAm8VcTZZ0P2oJCVLZ4ZDy5RK2UYxMxDlc`\n      )\n      .then(res => {\n        this.setState({\n          latitude: res.data.results[0].geometry.location.lat,\n          longitude: res.data.results[0].geometry.location.lng,\n          searchInput: \"\"\n        });\n      })\n      .then(() => {\n        this.fetchLocation().then(() => {\n          this.getDistanceData(this.coordinateString());\n        });\n      });\n  };\n\n  handleSearchInput = event => {\n    event.preventDefault();\n    this.setState({\n      searchInput: event.target.value\n    });\n  };\n\n  render() {\n    // console.log(this.props)\n    const {\n      markers,\n      latitude,\n      longitude,\n      userIP,\n      distances,\n      distanceChoice\n    } = this.state;\n    return (\n      <React.Fragment>\n        <div className=\"home-main-container\">\n\n          <SideBar\n            props={this.props} \n            distances={distances}\n            trails={markers}\n            currentLon={longitude}\n            currentLat={latitude}\n          />\n          <Map\n            markers={markers}\n            latitude={latitude}\n            longitude={longitude}\n            userIP={userIP}\n            distanceChoice={distanceChoice}\n          />\n          <div className=\"home-menus-container\">\n            <DistanceMenu selectDistance={this.selectDistance} />\n            <SortMenu handleSort={this.handleSort} />\n            <SearchBox\n              handleSearchInput={this.handleSearchInput}\n              searchCoordinates={this.searchCoordinates}\n              searchInput={this.state.searchInput}\n            />\n          </div>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}